<!DOCTYPE html>
<html>
<head>
	<title>Module 05: Project 5 Lab - DynamoDB</title>
    <style>
        @font-face {
            font-family: 'icomoon';
            src: url('https://byui-cse.github.io/itm300-course/shared/fonts/byui/icomoon.eot');
            src: url('https://byui-cse.github.io/itm300-course/shared/fonts/byui/icomoon.eot#iefix-8k8p81') format('embedded-opentype'), url('https://byui-cse.github.io/itm300-course/shared/fonts/byui/icomoon.ttf') format('truetype'), url('https://byui-cse.github.io/itm300-course/shared/fonts/byui/icomoon.woff') format('woff'), url('https://byui-cse.github.io/itm300-course/shared/fonts/byui/icomoon.svg#icomoon') format('svg');
            font-weight: normal;
            font-style: normal;
        }
    </style>
    <link rel="stylesheet" type="text/css" href="https://byui-cse.github.io/itm300-course/shared/reset.css">
    <link rel="stylesheet" type="text/css" href="https://byui-cse.github.io/itm300-course/shared/fonts/fontawesome/css/all.min.css">
    <link rel="stylesheet" type="text/css" href="https://byui-cse.github.io/itm300-course/shared/lib/katex/katex.min.css">
    <link rel="stylesheet" type="text/css" href="https://byui-cse.github.io/itm300-course/shared/lib/highlight/styles/monokai-sublime.min.css">
	<link rel="stylesheet" type="text/css" href="https://byui-cse.github.io/itm300-course/shared/cse450.css?v1.5.2">
    <meta charset="utf-8">

</head>
<body class="index-page">
     <div id="modal-screen">
        <div id="contents-wrapper">
            <div class="toc">
<ul>
<li><a href="#product-objective">Product Objective</a></li>
<li><a href="#instructions">Instructions</a></li>
<li><a href="#create-a-dynamodb-table">Create a DynamoDB table</a></li>
<li><a href="#update-lambda">Update Lambda</a></li>
<li><a href="#add-information-to-the-database">Add information to the database</a></li>
<li><a href="#update-a-vehicle">Update a vehicle</a></li>
<li><a href="#lab-summary">Lab Summary:</a><ul>
<li><a href="#key-concepts-explained">Key Concepts Explained:</a></li>
<li><a href="#reflection-questions">Reflection Questions:</a></li>
</ul>
</li>
</ul>
</div>

            <a href="#" id="hide-contents" title="Close Table of Contents"><i class="far fa-window-close"></i></a>
        </div>
    </div>
	<header>
        <span class="icon-byui-logo"></span>
        <div id="titles">
            <h1>ITM 300 - Cloud Foundations</h1>
            <h2>Module 05: Project 5 Lab - DynamoDB</h2>
            <nav><a href="https://byui-cse.github.io/itm300-course"><i class="fas fa-home"></i></a><a href="https://byui-cse.github.io/itm300-course/modules/">Modules</a><a href="https://byui-cse.github.io/itm300-course/test-prep/">Test Prep</a></nav>
        </div>
        <a href="#" id="show-contents" title="Show Table of Contents"><i class="far fa-list-alt"></i></a>
    </header>
	<article>
		<p><img alt="Quick Oil Change and Repair" src="https://byui-cse.github.io/itm300-course/shared/img/quick-logo-service-requests.jpg" />
<em><a href="https://openai.com/dall-e-3">Photo by Dall-E-3</a></em></p>
<h2 id="product-objective">Product Objective</h2>
<p>You will be creating a dynamodb table that will store service requests. We will also update our lambda function to pull from the database.</p>
<h2 id="instructions">Instructions</h2>
<p>We will do two main steps in this lab. First we will create a dynamodb table. This is where we will store future service requests and information about vehicles.</p>
<p>Second, we'll update the lambda function to read from the dynamodb table to pull in the information.</p>
<h2 id="create-a-dynamodb-table">Create a DynamoDB table</h2>
<p>Search for DynamoDB in AWS</p>
<ul>
<li>
<p>Create table</p>
</li>
<li>
<p>Table Name: <strong>VehicleServices</strong></p>
</li>
<li>
<p>Partition Key: <strong>license_plate</strong> (String)</p>
</li>
<li>
<p>Sort Key: <strong>service_id</strong> (String)</p>
</li>
<li>
<p>Customize Settings</p>
</li>
<li>
<p>Capacity mode: On-demand</p>
</li>
<li>
<p>Secondary Indexes: Create global index</p>
</li>
<li>Global Secondary Index:<ul>
<li>Index Name: StatusIndex</li>
<li>Partition Key: service_status (String)</li>
<li>Sort Key: license_plate (String)</li>
</ul>
</li>
<li>
<p>Create Index</p>
</li>
<li>
<p>Create Table</p>
</li>
</ul>
<p>Wait for the Status to be: Active</p>
<ul>
<li>
<p>Click on VehicleServices</p>
</li>
<li>
<p>Actions -&gt; Create Item</p>
</li>
<li>license_plate: 8B1111</li>
<li>service_id: 1</li>
<li>Add new attribute (String): phone_number: 208-444-5555</li>
<li>Add new attribute (String): service_description: Oil Change on a 2007 Saturn Outlook</li>
<li>Add new attribute (String): service_status: Finishing up</li>
<li>Create item</li>
</ul>
<h2 id="update-lambda">Update Lambda</h2>
<p>Search for Lambda and open your getServiceRequests lambda function</p>
<ul>
<li>Under Code -&gt; Right click on getServiceRequests and choose New File</li>
<li>Name it dynamoService.mjs</li>
<li>Paste the following code into that file:</li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="p">{</span> <span class="n">DynamoDBClient</span> <span class="p">}</span> <span class="kn">from</span> <span class="s2">&quot;@aws-sdk/client-dynamodb&quot;</span><span class="p">;</span>
<span class="kn">import</span> <span class="p">{</span>
  <span class="n">DynamoDBDocumentClient</span><span class="p">,</span>
  <span class="n">ScanCommand</span><span class="p">,</span>
  <span class="n">PutCommand</span><span class="p">,</span>
  <span class="n">GetCommand</span><span class="p">,</span>
  <span class="n">DeleteCommand</span><span class="p">,</span>
<span class="p">}</span> <span class="kn">from</span> <span class="s2">&quot;@aws-sdk/lib-dynamodb&quot;</span><span class="p">;</span>

    <span class="n">const</span> <span class="n">client</span> <span class="o">=</span> <span class="n">new</span> <span class="n">DynamoDBClient</span><span class="p">({});</span>

    <span class="n">const</span> <span class="n">mydynamodb</span> <span class="o">=</span> <span class="n">DynamoDBDocumentClient</span><span class="o">.</span><span class="n">from</span><span class="p">(</span><span class="n">client</span><span class="p">);</span>

    <span class="n">const</span> <span class="n">tableName</span> <span class="o">=</span> <span class="s2">&quot;VehicleServices&quot;</span><span class="p">;</span>    
<span class="n">export</span> <span class="n">const</span> <span class="n">getDynamoServiceRequests</span> <span class="o">=</span> <span class="k">async</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="n">const</span> <span class="n">statusToExclude</span> <span class="o">=</span> <span class="s2">&quot;Completed&quot;</span><span class="p">;</span>
    <span class="n">const</span> <span class="n">statusToExcludeNew</span> <span class="o">=</span> <span class="s2">&quot;New Request&quot;</span><span class="p">;</span>
    <span class="k">try</span> <span class="p">{</span>
        <span class="n">const</span> <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">TableName</span><span class="p">:</span> <span class="n">tableName</span><span class="p">,</span>
            <span class="n">FilterExpression</span><span class="p">:</span> <span class="s2">&quot;attribute_not_exists(service_status) OR (#service_status &lt;&gt; :status AND #service_status &lt;&gt; :statusNew)&quot;</span><span class="p">,</span>
            <span class="n">ExpressionAttributeNames</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;#service_status&quot;</span><span class="p">:</span> <span class="s2">&quot;service_status&quot;</span>
            <span class="p">},</span>
            <span class="n">ExpressionAttributeValues</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;:status&quot;</span><span class="p">:</span> <span class="n">statusToExclude</span><span class="p">,</span>
                <span class="s2">&quot;:statusNew&quot;</span><span class="p">:</span> <span class="n">statusToExcludeNew</span>
            <span class="p">}</span>
        <span class="p">};</span>      
        <span class="n">const</span> <span class="n">body</span> <span class="o">=</span> <span class="k">await</span> <span class="n">mydynamodb</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">new</span> <span class="n">ScanCommand</span><span class="p">(</span><span class="n">params</span><span class="p">));</span>
        <span class="k">return</span> <span class="n">body</span><span class="o">.</span><span class="n">Items</span><span class="p">;</span> <span class="o">//</span> <span class="n">Return</span> <span class="n">JSON</span> <span class="n">string</span> <span class="n">of</span> <span class="n">items</span>
    <span class="p">}</span> <span class="n">catch</span> <span class="p">(</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">console</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Error fetching DynamoDB service requests:&quot;</span><span class="p">,</span> <span class="n">error</span><span class="p">);</span>
        <span class="n">throw</span> <span class="n">error</span><span class="p">;</span> <span class="o">//</span> <span class="n">Re</span><span class="o">-</span><span class="n">throw</span> <span class="n">the</span> <span class="n">error</span> <span class="n">to</span> <span class="n">handle</span> <span class="n">it</span> <span class="n">further</span> <span class="n">up</span> <span class="n">the</span> <span class="n">call</span> <span class="n">stack</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<p>We will replace the previous dataService with the new dynamoService.</p>
<ul>
<li>Add this line to the top of the index.js file:</li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="p">{</span> <span class="n">getDynamoServiceRequests</span> <span class="p">}</span> <span class="kn">from</span> <span class="s1">&#39;./dynamoService.mjs&#39;</span><span class="p">;</span>
</code></pre></div>

<ul>
<li>Change the name of the function being called by repalacing <em>const jsonArray = await getServiceRequests();</em> with</li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="k">const</span><span class="w"> </span><span class="n">jsonArray</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">await</span><span class="w"> </span><span class="n">getDynamoServiceRequests</span><span class="p">();</span>
</code></pre></div>

<p>Click Deploy and then Test the deployment. You should only see the single response in the body instead of the three hardcoded items we had before.</p>
<p>Go to the website and verify that you are getting a single ticket back.</p>
<h2 id="add-information-to-the-database">Add information to the database</h2>
<p>Go back to the dynamodb table and click "explore table items"
Click run. Down below it should return the 8B1111 item</p>
<ul>
<li>Check the checkbox next to 8B1111. </li>
<li>Click Actions-&gt;Duplicate Item</li>
</ul>
<p>Update the values on this page to this:</p>
<ul>
<li>license_plate: 1J1957</li>
<li>service_id: 2</li>
<li>phone_number: 208-867-5309</li>
<li>service_description: Brakes for a 08 Mazda 3</li>
<li>status: Accepted</li>
</ul>
<p>Click create item</p>
<p>Go back to the website and you should see both items under service request.</p>
<h2 id="update-a-vehicle">Update a vehicle</h2>
<p>Go update the value of the service_status of the 8B1111 vehicle to have a <em>service_status</em> of <strong>Completed</strong></p>
<p>Go view the website and you should only see one service request.</p>
<h2 id="lab-summary">Lab Summary:</h2>
<p>In this lab, the primary objective was to create a DynamoDB table named <em>VehicleServices</em> to store service requests related to vehicle maintenance. Additionally, the lab focused on updating a Lambda function to interact with this DynamoDB table for fetching and manipulating service request data.</p>
<h3 id="key-concepts-explained">Key Concepts Explained:</h3>
<div class="admonition note">
<p class="admonition-title">DynamoDB</p>
<p>Amazon DynamoDB is a fully managed NoSQL database service provided by Amazon Web Services (AWS). It is designed to provide seamless scalability, low-latency performance, and high availability for applications that require fast and flexible data storage. DynamoDB is suitable for a wide range of use cases, from mobile and web applications to gaming, IoT (Internet of Things), and real-time analytics.</p>
<p>Key features and concepts of DynamoDB include:</p>
<p><strong>Fully Managed Service:</strong> DynamoDB is a serverless database service, which means AWS manages all aspects of database provisioning, scaling, and maintenance, allowing developers to focus on building applications without managing infrastructure.</p>
<p><strong>NoSQL Database:</strong> DynamoDB is a NoSQL (non-relational) database that offers flexible schema design, allowing developers to store and retrieve data in a schema-less format. It supports various data types, including scalar types (like string, number, boolean) and complex types (like lists and maps).</p>
<p><strong>Scalability and Performance:</strong> DynamoDB automatically scales to accommodate growing workloads by distributing data across multiple servers and partitions. It provides single-digit millisecond latency for read and write operations, making it suitable for applications that require high-performance data access.</p>
<p><strong>Data Model:</strong> DynamoDB uses primary keys for data retrieval and storage. Tables can have a partition key (and optionally a sort key), enabling efficient querying and indexing of data. Global and local secondary indexes can be defined to support different access patterns.</p>
<p><strong>Consistency and Durability:</strong> DynamoDB offers configurable consistency models (strong consistency or eventual consistency) based on application requirements. It also provides built-in replication and backup capabilities for data durability and disaster recovery.</p>
</div>
<ol>
<li><strong>DynamoDB:</strong> In this lab, a DynamoDB table was created with specific attributes like <em>license_plate</em> and <em>service_id</em> to store service request details.</li>
<li><strong>DynamoDB Table Configuration:</strong> The lab covered the configuration of a DynamoDB table, including defining a primary partition key (license_plate) and a sort key (service_id). Additionally, a global secondary index (StatusIndex) was created to facilitate efficient querying based on the <em>service_status</em> attribute.</li>
<li><strong>Lambda Function Integration with DynamoDB:</strong> The Lambda function (getServiceRequests) was updated to use the AWS SDK for DynamoDB to interact with the VehicleServices table. The function was modified to retrieve service requests based on certain filtering conditions (e.g., excluding completed or new requests) using a ScanCommand.</li>
<li><strong>Data Manipulation in DynamoDB:</strong> The lab demonstrated how to add and update items in the DynamoDB table directly from the AWS Management Console. By duplicating an existing item and updating its attributes (e.g., changing service_status to "Accepted" for a new service request).</li>
</ol>
<h3 id="reflection-questions">Reflection Questions:</h3>
<ul>
<li>Explain the significance of partition keys and sort keys in DynamoDB. How does the choice of these keys impact the performance and querying capabilities of the database table?</li>
<li>Discuss the benefits of using a global secondary index (GSI) in DynamoDB. What scenarios would require the creation of GSIs, and how do they enhance query flexibility?</li>
<li>Reflect on the differences between scanning and querying data in DynamoDB. Why is it important to optimize data access patterns to minimize resource consumption and improve performance?</li>
<li>Describe the role of Lambda functions in serverless architectures. How does integrating Lambda with DynamoDB enable event-driven data processing and application logic execution?</li>
<li>Explore the challenges and best practices of managing NoSQL databases like DynamoDB for scalable and responsive applications. How can developers optimize data modeling and indexing strategies to ensure efficient data access and storage?</li>
<li>Consider the trade-offs between NoSQL and relational databases for cloud-based applications. What factors would influence the choice of database technology based on application requirements and scalability considerations?</li>
</ul>
	</article>
	<script src="https://byui-cse.github.io/itm300-course/shared/lib/highlight/highlight.pack.js"></script>
	<script src="https://byui-cse.github.io/itm300-course/shared/lib/katex/katex.min.js"></script>
    <script src="https://byui-cse.github.io/itm300-course/shared/lib/katex/contrib/auto-render.min.js"></script>
	<script src="https://byui-cse.github.io/itm300-course/shared/lib/smartquotes/smartquotes.min.js"></script>
    <script>

        /* Startup scripts for katex rendering */
    	renderMathInElement(document.body,
		{
			delimiters: [
				{left: "$$", right: "$$", display: true},
				{left: "$", right: "$", display: false},
			]
    	});

        /* Highlighting code */
    	hljs.initHighlightingOnLoad();
    	var elements = document.querySelectorAll('.language-text')
		for (var i = 0; i < elements.length; i++) {
  			elements[i].classList.add('hljs');
		}

        /* TOC support */
        var hideContents = function(e){
            console.log(e.target);
            if(e.target.id === 'modal-screen' || e.target.nodeName.toLowerCase() === 'i') {
                e.preventDefault();
                document.querySelector('#contents-wrapper').classList.remove('active');
                document.querySelector('#modal-screen').classList.remove('active');
            }
        }

        var showContents = function(e){
            e.preventDefault();
            document.querySelector('#contents-wrapper').classList.add('active');
            document.querySelector('#modal-screen').classList.add('active');
        }

        document.querySelector("#hide-contents").addEventListener('click', hideContents);
        document.querySelector("#modal-screen").addEventListener('click', hideContents);
        document.querySelector("#show-contents").addEventListener('click', showContents);
    	
    </script>
</body>
</html>